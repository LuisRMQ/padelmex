<div *ngIf="!selectedUsuario">

  <!-- Encabezado -->
  <div class="header">
    <h2>Usuarios</h2>
    <button mat-raised-button color="accent" class="btn-agregar" (click)="abrirModalRegistrarUsuario()">
      <mat-icon>add</mat-icon> AGREGAR USUARIO
    </button>
  </div>

  <div class="usuarios-container">

    <!-- Filtros y resumen -->
    <div class="usuarios-filtros">
      <input class="usuarios-search" type="text" placeholder="Buscar usuarios..." (keyup)="applyFilter($event)">
      <!-- <mat-form-field appearance="outline" class="usuarios-select">
        <mat-label>Roles</mat-label>
        <mat-select [(ngModel)]="selectedRol">
          <mat-option value="">Todos los roles</mat-option>
          <mat-option *ngFor="let rol of roles" [value]="rol.id">{{ rol.name }}</mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field appearance="outline" class="usuarios-select">
        <mat-label>Categorías</mat-label>
        <mat-select [(ngModel)]="selectedCategoria">
          <mat-option value="">Todas las categorías</mat-option>
          <mat-option *ngFor="let cat of categories" [value]="cat.id">{{ cat.name }}</mat-option>
        </mat-select>
      </mat-form-field> -->
    </div>

    <!-- Tarjetas resumen -->
    <div class="usuarios-resumen">
      <div class="resumen-card">
        <div class="resumen-icon total"><mat-icon>groups</mat-icon></div>
        <div class="resumen-label">Total Usuarios</div>
        <div class="resumen-value">{{ getTotalUsuarios() }}</div>
      </div>
      <div class="resumen-card">
        <div class="resumen-icon activos"><mat-icon>directions_run</mat-icon></div>
        <div class="resumen-label">Jugadores Activos</div>
        <div class="resumen-value">{{ getTotalUsuariosByRol('jugador') }}</div>
      </div>
      <div class="resumen-card">
        <div class="resumen-icon entrenadores"><mat-icon>emoji_events</mat-icon></div>
        <div class="resumen-label">Entrenadores</div>
        <div class="resumen-value">{{ getTotalUsuariosByRol('coach') }}</div>
      </div>
      <div class="resumen-card">
        <div class="resumen-icon victorias"><mat-icon>military_tech</mat-icon></div>
        <div class="resumen-label">Categoria con mas Usuarios</div>
        <div class="resumen-value">{{ getCategoriaConMasUsuarios() }}</div>
      </div>
    </div>

    <!-- Tabla de usuarios -->
    <div class="usuarios-lista">
      <div class="usuarios-lista-header">
        <span>Lista de Usuarios</span>
      </div>
      <table class="usuarios-table">
        <thead>
          <tr>
            <th>NOMBRE</th>
            <th>TELEFONO</th>
            <th>ROL</th>
            <th>CLUB</th>
            <th>CATEGORÍA</th>
            <th>ACCIONES</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let usuario of usuariosFiltrados">
            <td>
              <div class="usuario-nombre">
                <img class="usuario-avatar" [src]="usuario.fotoPerfil || 'assets/img/user.png'" alt="avatar">
                <div>
                  <div class="nombre">{{ usuario.nombre }} {{ usuario.apellidos }}</div>
                  <div class="correo">{{ usuario.correo }}</div>
                </div>
              </div>
            </td>
            <td>
              <span>{{usuario.area_code}} {{usuario.telefono}}</span>
            </td>
            <td>
              <span class="badge-rol" [ngClass]="usuario.rol | lowercase">{{ usuario.rol }}</span>
            </td>
            <td>
              {{ usuario.club }}
            </td>
            <td>
              <span class="badge-categoria" [ngClass]="usuario.categoria | lowercase">{{ usuario.categoria }}</span>
            </td>
            <td>
              <button mat-icon-button color="primary" (click)="verDetalle(usuario)">
                <mat-icon>visibility</mat-icon>
              </button>
              <button mat-icon-button color="accent" (click)="abrirModalEditarUsuario(usuario)">
                <mat-icon>edit</mat-icon>
              </button>
              <button mat-icon-button color="warn" (click)="eliminarUsuario(usuario)">
                <mat-icon>delete</mat-icon>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>