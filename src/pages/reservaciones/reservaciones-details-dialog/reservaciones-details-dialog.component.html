<div class="dialog-container">
  <!-- Header -->
  <div class="dialog-header">
    <h2>Detalles de Reservación</h2>
    <span class="reservation-id">ID: #{{ data.id }}</span>
  </div>

  <mat-divider style="opacity: 0.12;"></mat-divider>

  <!-- Status -->
  <div class="status-container">
    <ng-container *ngIf="!isEditing; else editStatus">
      <h3>Status</h3>
      <span class="status-badge" [ngClass]="data.details.status">
        {{ data.details.status | titlecase }}
      </span>
    </ng-container>
    <ng-template #editStatus>
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>Status</mat-label>
        <mat-select [(ngModel)]="editedData.status">
          <mat-option value="confirmed">Confirmada</mat-option>
          <mat-option value="pending">Pendiente</mat-option>
          <mat-option value="cancelled">Cancelada</mat-option>
        </mat-select>
      </mat-form-field>
    </ng-template>
  </div>

  <!-- Fecha y Cancha -->
  <div class="row">
    <div class="card blue-card">
      <h4><mat-icon>access_time</mat-icon> Fecha y Hora</h4>
      <ng-container *ngIf="!isEditing; else editDate">
        <p><strong>Fecha:</strong> {{ formatDateString(data.details.date) }}</p>
        <p><strong>Inicio:</strong> {{ data.details.start_time }}</p>
        <p><strong>Fin:</strong> {{ data.details.end_time }}</p>
        <p><strong>Duración:</strong> {{ data.details.duration }}</p>
      </ng-container>
      <ng-template #editDate>
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Fecha</mat-label>
          <input matInput type="date" [(ngModel)]="editedData.date">
        </mat-form-field>
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Hora de Inicio</mat-label>
          <input matInput type="time" [(ngModel)]="editedData.start_time">
        </mat-form-field>
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Hora de Fin</mat-label>
          <input matInput type="time" [(ngModel)]="editedData.end_time">
        </mat-form-field>
      </ng-template>
    </div>

    <div class="card green-card">
      <h4><mat-icon>sports_tennis</mat-icon> Información de la Cancha</h4>
      <p><strong>Cancha: </strong>{{ data.details.court.name }}</p>
      <p><strong>Usuario:</strong> {{ data.user }}</p>
      <p><strong>Tipo:</strong> Standard</p>
    </div>
  </div>

  <!-- Jugadores -->
  <div class="card green-card">
    <h4><mat-icon>people</mat-icon> Jugadores</h4>
    <div class="players-grid">
      <ng-container *ngFor="let player of players">
        <div class="player-card">
          <img [src]="player.profile_photo || 'assets/default-user.png'" (error)="onImgError($event)"
            alt="{{ player.name }}" />
          <p>{{ player.name }} {{ player.lastname }}</p>
        </div>
      </ng-container>
      <ng-container *ngIf="players.length === 0">
        <p>No hay jugadores adicionales.</p>
      </ng-container>
    </div>
  </div>

  <!-- Observaciones -->
  <div class="card blue-card">
    <h4><mat-icon>sticky_note_2</mat-icon> Observaciones</h4>
    <ng-container *ngIf="!isEditing; else editObs">
      <input class="observation-input" type="text" [value]="data.details.observations" readonly />
    </ng-container>
    <ng-template #editObs>
      <textarea [(ngModel)]="editedData.observations"></textarea>
    </ng-template>
  </div>

  <!-- Footer y Acciones -->
  <div class="footer">
    <small>Created: {{ data.details.created_at }}</small>
    <small>Last Updated: {{ data.details.updated_at }}</small>
  </div>

  <div class="actions">
    <button class="btn btn-close" (click)="closeDialog()">Cerrar</button>

  </div>
</div>